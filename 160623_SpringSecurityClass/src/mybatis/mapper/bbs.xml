<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bbs">

	<insert id="ins" parameterType="bbsVO">
		insert into sp_bbs values(
		sp_bbs_seq.nextVal,#{sub},#{writer},#{pwd},
		#{cont},#{reip},0,sysdate
		)
	</insert>
	
	<select id="list" resultType="bbsVO" parameterType="searchVO">
		select num,sub,writer,hit,to_char(regdate,'yyyy-mm-dd') regdate
		from
		(
		select rownum as r_num, a.*
		from
		(select * from sp_bbs order by num desc
		) a
		)
		where r_num between #{begin} and #{end}
	</select>
	
	<select id="listTotal" resultType="int">
		select count(*) cnt from sp_bbs
	</select>
	
	<select id="detail" parameterType="int" resultType="bbsVO">
		select num,sub,writer,cont,reip,hit,
		to_char(regdate,'yyyy-mm-dd') regdate
		from sp_bbs where num=#{num}
	</select>



	<insert id="commIn" parameterType="bbscommVO">
		insert into sp_bbscomm values(
		sp_bbscomm_seq.nextVal,#{kcode},
		#{cnt},#{writer},#{comm},#{reip},sysdate
		)
	</insert>
	
	<select id="commList" parameterType="int" resultType="bbscommVO">
		select num,kcode,cnt,writer,comm,reip,
		to_char(regdate,'yyyy-mm-dd') regdate
		from sp_bbscomm where kcode=#{kcode} order by 1 desc
	</select>


	<update id="hitup" parameterType="int">
		update sp_bbs set hit = hit + 1
		where num = #{num}
	</update>
</mapper>
